# CI/CD Templates for Report Automation

Ready-to-use CI/CD configurations for automated report generation.

## GitHub Actions

### Daily Report

```yaml
# .github/workflows/daily-report.yml
name: Daily Work Report

on:
  schedule:
    - cron: '0 9 * * 1-5'  # 9 AM UTC, Mon-Fri
  workflow_dispatch:

jobs:
  generate-report:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install Claude Code
        run: npm install -g @anthropic/claude-code

      - name: Generate Report
        env:
          ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
        run: |
          mkdir -p reports
          claude --dangerously-skip-permissions \
            -p "Generate a daily work report and save to reports/daily-$(date +%Y-%m-%d).md"

      - name: Commit Report
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add reports/
          git diff --staged --quiet || git commit -m "chore: daily report $(date +%Y-%m-%d)"
          git push
```

### Weekly Report with PR

```yaml
# .github/workflows/weekly-report.yml
name: Weekly Work Report

on:
  schedule:
    - cron: '0 17 * * 5'  # Friday 5 PM UTC
  workflow_dispatch:

jobs:
  generate-report:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Install Claude Code
        run: npm install -g @anthropic/claude-code

      - name: Generate Report
        env:
          ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
        run: |
          mkdir -p reports
          claude --dangerously-skip-permissions \
            -p "Generate a weekly work report"

      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          commit-message: "chore: weekly report week $(date +%V)"
          title: "Weekly Report - Week $(date +%V)"
          body: |
            ## Automated Weekly Report

            This PR contains the weekly work report for week $(date +%V).

            Generated by GitHub Actions.
          branch: weekly-report-$(date +%Y%V)
          base: main
```

### Multi-Project Report

```yaml
# .github/workflows/multi-project-report.yml
name: Multi-Project Report

on:
  schedule:
    - cron: '0 18 * * 5'
  workflow_dispatch:

jobs:
  generate-report:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        project: [frontend, backend, mobile]

    steps:
      - uses: actions/checkout@v4
        with:
          repository: org/${{ matrix.project }}
          path: ${{ matrix.project }}
          fetch-depth: 0

      - name: Generate Report
        env:
          ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
        run: |
          cd ${{ matrix.project }}
          npx @anthropic/claude-code --dangerously-skip-permissions \
            -p "Generate weekly report"

      - name: Upload Artifact
        uses: actions/upload-artifact@v4
        with:
          name: report-${{ matrix.project }}
          path: ${{ matrix.project }}/reports/
```

## GitLab CI/CD

### Basic Configuration

```yaml
# .gitlab-ci.yml
stages:
  - report

variables:
  ANTHROPIC_API_KEY: $ANTHROPIC_API_KEY

daily-report:
  stage: report
  image: node:20
  rules:
    - if: $CI_PIPELINE_SOURCE == "schedule"
  script:
    - npm install -g @anthropic/claude-code
    - mkdir -p reports
    - claude --dangerously-skip-permissions -p "Generate daily report"
  artifacts:
    paths:
      - reports/
    expire_in: 30 days

weekly-report:
  stage: report
  image: node:20
  rules:
    - if: $CI_PIPELINE_SOURCE == "schedule"
    - if: $REPORT_TYPE == "weekly"
  script:
    - npm install -g @anthropic/claude-code
    - claude --dangerously-skip-permissions -p "Generate weekly report"
  artifacts:
    paths:
      - reports/
```

### GitLab Schedule Setup

1. Go to CI/CD > Schedules
2. Create new schedule:
   - Description: "Daily Report"
   - Interval Pattern: `0 18 * * 1-5`
   - Target Branch: main

## Azure DevOps

```yaml
# azure-pipelines.yml
trigger: none

schedules:
  - cron: "0 18 * * 1-5"
    displayName: Daily Report
    branches:
      include:
        - main

pool:
  vmImage: 'ubuntu-latest'

steps:
  - task: NodeTool@0
    inputs:
      versionSpec: '20.x'

  - script: npm install -g @anthropic/claude-code
    displayName: 'Install Claude Code'

  - script: |
      claude --dangerously-skip-permissions \
        -p "Generate daily work report"
    env:
      ANTHROPIC_API_KEY: $(ANTHROPIC_API_KEY)
    displayName: 'Generate Report'

  - task: PublishBuildArtifacts@1
    inputs:
      PathtoPublish: 'reports'
      ArtifactName: 'work-reports'
```

## Jenkins

```groovy
// Jenkinsfile
pipeline {
    agent any

    triggers {
        cron('0 18 * * 1-5')
    }

    environment {
        ANTHROPIC_API_KEY = credentials('anthropic-api-key')
    }

    stages {
        stage('Setup') {
            steps {
                sh 'npm install -g @anthropic/claude-code'
            }
        }

        stage('Generate Report') {
            steps {
                sh '''
                    claude --dangerously-skip-permissions \
                        -p "Generate daily work report"
                '''
            }
        }

        stage('Archive') {
            steps {
                archiveArtifacts artifacts: 'reports/**/*.md'
            }
        }
    }

    post {
        success {
            slackSend channel: '#reports',
                message: "Daily report generated: ${env.BUILD_URL}"
        }
    }
}
```

## CircleCI

```yaml
# .circleci/config.yml
version: 2.1

jobs:
  generate-report:
    docker:
      - image: cimg/node:20.0
    steps:
      - checkout
      - run:
          name: Install Claude Code
          command: npm install -g @anthropic/claude-code
      - run:
          name: Generate Report
          command: |
            claude --dangerously-skip-permissions \
              -p "Generate daily work report"
      - store_artifacts:
          path: reports
          destination: work-reports

workflows:
  daily-report:
    triggers:
      - schedule:
          cron: "0 18 * * 1-5"
          filters:
            branches:
              only:
                - main
    jobs:
      - generate-report
```

## Secrets Management

### GitHub Actions

```bash
# Set secret via CLI
gh secret set ANTHROPIC_API_KEY --body "sk-xxx"
```

### GitLab

1. Settings > CI/CD > Variables
2. Add `ANTHROPIC_API_KEY` as masked variable

### Best Practices

1. Never commit API keys
2. Use CI/CD secret management
3. Rotate keys periodically
4. Use minimum required permissions
